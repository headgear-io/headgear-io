<!doctype html>
<html lang="en">
  <head>
    <!-- copyright 2020 Headgear Gbr -->
	<!-- for support please contact support@headgear.io -->
	
	<!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="icon" type="image/png" href="https://headgear.io/assets/img/HLOGO.ico">
	
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<!-- Flat UI CSS stylesheet -->
    <link href="https://designmodo.github.io/Flat-UI/dist/css/flat-ui.css" rel="stylesheet">
	
	<script src="https://vjs.zencdn.net/6.6.3/video.js"></script>
	
    <title>HTML AR Template</title>
	
	<script>
		var toolVersionVar = "1.0.2";
		var templateName_var = "";
	</script>
	
	
	<!-- project specific CSS -->
	<style>
		.divcss {padding: 2px 20px 50px;}
		
		.body-background {
			background-color: #f5f5f5;
		}
		.center-col {
			position:absolue; 
			width:800px; 
			margin: 0 auto;
			padding:20px 20px 20px 20px;
			border: none;
			border-radius: 6px;
			background-color: white;
			box-shadow: 0px 5px 5px 0 rgba(0,0,0,0.5);
		}
		.navbar a {
			text-align:center;
			width:100%;
		}
		.icon-checked {
			font-size:25px; !important
		}
		.icon-unchecked {
			font-size:25px; !important
		}
		#overlay {
			position: fixed;
			display: none;
			width: 100%;
			height: 100%;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background-color: rgba(0,0,0,0.5);
			z-index: 2;
			cursor: pointer;
		}
		.dropdown-menu		{
			color: white !important;
			cursor: pointer;
		}}
	</style>
</head>
<body class="body-background">

<div id="overlay" onclick="overlayOff()">
	<div style="width: 100%; height: auto; margin: 0 auto; padding: 10px; position: relative;">
		<img src="https://www.8thwall.com/docs/web/images/console-gettingstarted-copy-appkey.jpg" >
	</div>
</div>

<div class="divcss">
	 <div class="container">

	  <nav class="navbar navbar-inverse navbar-expand-lg" role="navigation">
			<!-- Navbar content -->
			<img src="https://headgear.io/assets/img/IMG_0088.PNG" style="width:50px; height:50px;"><a class="navbar-brand" href="#">HTML AR Template Tool</a><img src="https://headgear.io/assets/img/IMG_0088.PNG" style="width:50px; height:50px; -webkit-transform: scaleX(-1); transform: scaleX(-1);">


	</div>
	<div id="templateSelector" class="row">
		<div class="center-col" style="" >
		<div class="tile">
            <img src="https://www.axelspringer.com/data/uploads/2019/04/wams-1.svg" alt="Infinity-Loop" class="tile-image" style="height:200px; margin: 0 0 0;">
            <!--<h3 class="tile-title">Easy to Customize</h3>
            <p>Vector-based shapes and minimum of layer styles.</p>-->
            <a class="btn btn-primary btn-large btn-block" href="#" onclick="templateName_var ='WAmS'; loadTemplate(templateName_var);" style="font-size:30px;">Load Welt Am Sonntag Template</a>
          </div>
		</div>
	</div>
	<div id="templateContent" style="display:none;" class="row">
			<div class="center-col" >
				<div id="pageTitleContainer" class="form-group" data-html="true" data-toggle="tooltip" data-placement="left" title="Page title seen on the browser window and page bookmarks. <br><b>Mandatory</b>">
					<h4>Page Title<b>*</b> : </h4>
					  <input id="pageTitle_value" type="text" class="form-control" placeholder="Page title to be shown by browser window and page bookmarks." data-toggle="tooltip" data-placement="top" title="">
				</div>
				<div id="keyKeyContainer" class="form-group" data-html="true" data-toggle="tooltip" data-placement="left" title="App Key from 8th Wall console. Usually 70 chars long. <br><b>Mandatory</b>">
					<h4>App Key<b>*</b> : <a href="#" onclick="overlayOn()" data-toggle="tooltip" data-placement="right" data-html="true" title="Located in Project -> Settings -> AppKey <br>Click for screenshot."> ?</a></h4> 
						<input id="appKey_value" type="text" class="form-control" placeholder="App Key from 8th Wall console. eg: gLMESoMSiCXZ8Ye4C7ooAO5bRn59zFpGIxN07SWCegxZNtScEoTCxh8S9SsXTB8xOevOSn" data-toggle="tooltip" data-placement="top" title="Usually approx 70 chars long">
						<a href="https://www.8thwall.com/spring" target="_blank">8thWall Link</a>
				</div>
			<div id="modelContainer">
				<h4>Models</h4>
				<div id="doorModelContainer" class="form-group" data-html="true" data-toggle="tooltip" data-placement="left" title="Enter the URL to where the door model glb file has been uploaded. Relative paths also supported <br><b>Mandatory</b>">
					<h6>Door Model<b>*</b> :</h6>
					<input id="doorModel_value" type="text" class="form-control" onfocusout="setStatus(document.getElementById('doorModel_value').value, 'doorModelContainer');" placeholder="URL to door model. *.glb file expected" data-toggle="tooltip" data-placement="top" title="Full path with https or Relative path with ./folder/filename.glb" >
				</div>
				<div id="balconyModelContainer" class="form-group" data-html="true" data-toggle="tooltip" data-placement="left" title="Should the experience contain a balcony? If so enter the URL to where the door model glb file has been uploaded. Relative paths also supported <br><i>(Optional)</i>">
					<h6 >Balcony Model:</h6>
						<!-- balcony model switch -->
						<span class="mrl" onclick="document.getElementById('balconyModel_value').disabled = !document.getElementById('showBalcony_value').checked;">
							<input type="checkbox" checked data-toggle="switch" id="showBalcony_value" />
						</span> Include Balcony?
						<br><br>
					  <input id="balconyModel_value" type="text" class="form-control" onfocusout="setStatus(document.getElementById('balconyModel_value').value, 'balconyModelContainer');" placeholder="URL to balcony model. *.glb file expected" data-toggle="tooltip" data-placement="top" title="Full path with https or Relative path with ./folder/filename.glb">
				</div>
			</div>
			<br>
			<div id="360videoOrPhotoContainer" class="form-group" data-toggle="tooltip" data-placement="left" data-html="true" title="Should the portal contain a 360 Video <br><b>or</b><br> a 360 Image? <br><b>Mandatory</b>">
				 <h4>360 Video / Photo <b>*</b></h4>
				  <label class="radio" for="videoElsePhoto_value" style="width:200px" data-toggle="tooltip" data-placement="right" title="Portal should contain 360 Video." onclick="switchVideoPhotoDiv()">
					<input type="radio" name="optionsRadios" data-toggle="radio" value="" id="videoElsePhoto_value" required="" checked="" class="custom-radio" ><span class="icons" ><span class="icon-unchecked"></span><span class="icon-checked"></span></span>
					 360 Video
				  </label>
				  <label class="radio" for="videoElsePhoto_valueb" style="width:200px; " data-toggle="tooltip" data-placement="right" title="Portal should contain 360 Photo." onclick="switchVideoPhotoDiv()">
					<input type="radio" name="optionsRadios" data-toggle="radio" value="" id="videoElsePhoto_valueb" required="" class="custom-radio"><span class="icons"><span class="icon-unchecked"></span><span class="icon-checked"></span></span>
					 360 Photo
				  </label>
				  <div class="btn-group" data-toggle="tooltip" data-placement="center" title="Initial Rotation of 360 content. Default is 90 Degrees">
					  360 content initial rotation: &nbsp;&nbsp; <button id="360Rotation_value" class="btn btn-inverse dropdown-toggle" type="button" data-toggle="dropdown">90</button>
					  <ul class="dropdown-menu dropdown-menu-inverse" role="menu">
						<li><a onclick="setRotation('0');">0</a></li>
						<li><a onclick="setRotation('90');">90</a></li>
						<li><a onclick="setRotation('180');">180</a></li>
						<li><a onclick="setRotation('270');">270</a></li>
					  </ul>
					</div>
				
					<div id="videoInfo" >
						<h6 data-toggle="tooltip" data-placement="left" title="Enter the URL to where the video file has been uploaded. Relative paths also supported."> Video URL:</h6>
						  <div id="videoFormGroup" class="form-group">
							<div class="input-group">
							  <input id="videoURL_value" type="text" class="form-control" onfocusout="setStatus(document.getElementById('videoURL_value').value, 'videoFormGroup');" placeholder="Video URL starting with https:// & should be *.mp4" data-toggle="tooltip" data-placement="top" data-html="true" title="Enter in the <b>full URL</b> of where your 360 video is hosted. (starts with https:// & should be *.mp4) (Relative paths also supported)" >
							  <span class="input-group-btn">
								<button class="btn btn-default" type="button" onclick="previewVideo()" data-toggle="tooltip" data-placement="top" title="Press to make sure video file exists and is the one you were expecting.">Preview</button>
							  </span>
							</div><!-- /input-group -->
						  </div><!-- /.form-group -->
							<div class="thumbnail" style="height:340px;" data-toggle="tooltip" data-placement="left" title="Preview window so you can see if the URL is correct. Press the Preview button first.">
								<video id="videoPreviewWindow" class="video-js" controls preload="auto" poster="" data-setup="{}" style="width:600px; height:280px;  margin: 0 auto;" src="">
									<!-- <source src="https://vatelier.net/MyDemo/videosphere-showcase/city_halfres.mp4" type="video/mp4">  -->
								</video>
							</div>
					
						
					</div>
					<div id="photoInfo" style="display:none;">
				
						<h6 data-toggle="tooltip" data-placement="left" title="Enter the URL to where the image file has been uploaded. Relative paths also supported.Relative paths also supported.">Photo URL:</h6>
						  <div id="photoFormGroup" class="form-group">
							<div class="input-group">
							  <input id="photoURL_value" type="text" class="form-control" onfocusout="setStatus(document.getElementById('photoURL_value').value, 'photoFormGroup');" placeholder="Image URL starting with https://" data-toggle="tooltip" data-placement="top" data-html="true" title="Enter in the <b>full URL</b> of where your 360 image is hosted. (starts with https://) (Relative paths also supported)">
							  <span class="input-group-btn">
								<button class="btn btn-default" type="button" onclick="previewImage()" data-toggle="tooltip" data-placement="top" title="Press to make sure image exists and is the one you were expecting.">Preview</button>
							  </span>
							</div><!-- /input-group -->
						  </div><!-- /.form-group -->
							
							  <a class="thumbnail" href="#" data-toggle="tooltip" data-placement="left" title="Preview window so you can see if the URL is correct. Press the Preview button first.">
								<img id="photoPreviewWindow" alt="Preview Window: Recommended resolution no less than 3840 x 2160 (4k)" style="height: 330px; width: 500px; display: block;" src="#" data-holder-rendered="true">
							  </a>
						
					</div>
			</div>
			<br>
		<div id="remainingSettings">
			
			<div id="narrativeContainer" data-toggle="tooltip" data-html="true" data-placement="left" title="Does the experience contain a separate narrative audio track? Supported Format: mp3  Relative paths also supported.<br><i>(Optional)</i>">
				<h4>Narrative Audio Track:</h4>
				<!-- switch -->
						<span class="mrl" onclick="document.getElementById('narrative_value').disabled = !document.getElementById('showNarrativeAudioButton_value').checked; document.getElementById('audioPreview').disabled = !document.getElementById('showNarrativeAudioButton_value').checked;">
							<input type="checkbox" checked data-toggle="switch" id="showNarrativeAudioButton_value" title=""/>
						</span> Does the experience contain a separate narrative audio track?
					<!-- end switch -->
						<br><br>
				<div id="audioFormGroup" class="form-group">
				  <div class="input-group">
				  <input id="narrative_value" type="text" class="form-control" onfocusout="setStatus(document.getElementById('narrative_value').value, 'audioFormGroup');" placeholder="Audio URL starting with https:// & should be *.mp3" data-toggle="tooltip" data-placement="top" data-html="true" title="Enter in the <b>full URL</b> of where your mp3 file is hosted. (starts with https://) & should be *.mp3 (Relative paths also supported)">
				  <span class="input-group-btn">
					<button id="audioPreview" class="btn btn-default" type="button" onclick="previewAudio('audioPlayer', document.getElementById('narrative_value').value, 'audioFormGroup')" data-toggle="tooltip" data-placement="top" title="Press to make sure audio track exists and is the one you were expecting.">Preview</button>
				  </span>
				  </div>
				</div>
				<div id="audioPlayerDiv" style="text-align:center">
					<audio id="audioPlayer" controls="controls" data-toggle="tooltip" data-placement="top" title="Listen to make sure audio track exists and is the one you were expecting.">
					  <source id="audioSource" src=""></source>
					  Your browser does not support the audio format.
					</audio>
				</div>
			</div>
			<br>
			
			<div id="doorSpawningSoundContainer" data-toggle="tooltip" data-html="true" data-placement="left" title="Should the experience play a sound when spawning the door? Supported Format: mp3 Relative paths also supported.<br><i>(Optional)</i>">
				<h4>Door Spawning Audio:</h4>
				<!-- switch -->
						<span class="mrl" onclick="document.getElementById('doorSpawningSound_value').disabled = !document.getElementById('containsDoorSpawningSound_value').checked; document.getElementById('doorSpawningSoundPreview').disabled = !document.getElementById('containsDoorSpawningSound_value').checked;">
							<input type="checkbox" checked data-toggle="switch" id="containsDoorSpawningSound_value" title=""/>
						</span> Should the experience play a sound when spawning the door?
					<!-- end switch -->
						<br><br>
				<div id="doorSpawningSoundFormGroup" class="form-group">
				  <div class="input-group">
				  <input id="doorSpawningSound_value" type="text" class="form-control" onfocusout="setStatus(document.getElementById('doorSpawningSound_value').value, 'doorSpawningSoundFormGroup');" placeholder="Audio URL starting with https:// & should be *.mp3" data-toggle="tooltip" data-placement="top" data-html="true" title="Enter in the <b>full URL</b> of where your mp3 file is hosted. (starts with https://) & should be *.mp3 (Relative paths also supported)">
				  <span class="input-group-btn">
					<button id="doorSpawningSoundPreview" class="btn btn-default" type="button" onclick="previewAudio('doorSpawningSoundPlayer', document.getElementById('doorSpawningSound_value').value, 'doorSpawningSoundFormGroup')" data-toggle="tooltip" data-placement="top" title="Press to make sure audio track exists and is the one you were expecting.">Preview</button>
				  </span>
				  </div>
				</div>
				<div id="doorSpawningSoundPlayerDiv" style="text-align:center">
					<audio id="doorSpawningSoundPlayer" controls="controls" data-toggle="tooltip" data-placement="top" title="Listen to make sure audio track exists and is the one you were expecting.">
					  <source id="doorSpawningSoundSource" src=""></source>
					  Your browser does not support the audio format.
					</audio>
				</div>
			</div>
			
			<br>
				<div id="sceneLocationContainer" data-toggle="tooltip" data-html="true" data-placement="left" title="Should the experience contain a scene location text above the portal door? If so enter the text, should not be more than 32 Chars <br><i>(Optional)</i>">
					<h4>Scene Location Text:</h4>
					<!-- switch -->
						<span class="mrl" onclick="document.getElementById('sceneLocationText_value').disabled = !document.getElementById('sceneLocation_value').checked;">
							<input type="checkbox" checked data-toggle="switch" id="sceneLocation_value" title="Show scene location text above door? If so enter text in field below."/>
						</span> Show Scene Location Text?
					<!-- end switch -->
						<br><br>
					<div class="form-group">
					  
					  <input id="sceneLocationText_value" type="text" class="form-control" placeholder="Text to be shown above the door. No more than 32 Chars." data-toggle="tooltip" data-placement="top" title="Text to be shown above the door. No more than 32 Chars.">
					</div>
				</div>
				<br>
				<div id="infoLinkContainer" data-toggle="tooltip" data-html="true" data-placement="left" title="Should the menu UI include an Info Button that open an external URL? <br><i>(Optional)</i>">
					<h4>Info Link URL:</h4>
					<!-- switch -->
						<span class="mrl" onclick="document.getElementById('infoLink_value').disabled = !document.getElementById('showInfoButton_value').checked;">
							<input type="checkbox" checked data-toggle="switch" id="showInfoButton_value" title=""/>
						</span> Add info button sending user to an external URL?
					<!-- end switch -->
					<br><br>
					<div id="infoLinkFormGroup" class="form-group"> 
					  <input id="infoLink_value" type="text" class="form-control" onfocusout="setStatus(document.getElementById('infoLink_value').value, 'infoLinkFormGroup');" placeholder="URL that the Info Button links to. Should start with https://" data-toggle="tooltip" data-placement="top" title="URL that the Info Button links to. Should start with https://">
					</div>
				</div>
				<br>
				<div id="trackingContainer" class="form-group" data-html="true" data-toggle="tooltip" data-placement="left" title="Choose which tracking provider to configure <br><i>(Optional)</i>">
					<h4>3rd Party Tracking:</h4>
					<div class="btn-group">
					  <button id="trackingProvider_value" class="btn btn-inverse dropdown-toggle" type="button" data-toggle="dropdown">Choose Tracking Provider</button>
					  <ul class="dropdown-menu dropdown-menu-inverse" role="menu">
						<li data-toggle="tooltip" data-placement="left" data-html="true" title="Tealium uses the <b>Page Title</b> field as it's tracking identifier"><a onclick="setupTracking('Tealium'); document.getElementById('trackingParameter_value').disabled = false;">Tealium</a></li>
						<li class="divider"></li>
						<li data-toggle="tooltip" data-placement="left" title="No 3rd party tracking."><a onclick="setupTracking('None'); document.getElementById('trackingParameter_value').disabled = true;">None</a></li>
					  </ul>
					</div>
					<h6 style="display:none;">Tracking Id:</h6>
					  <input style="display:none;" id="trackingParameter_value" disabled type="text" class="form-control" placeholder="Tracking id for this AR campaign" data-toggle="tooltip" data-placement="top" data-html="true" title="Tracking id for this AR campaign">
				</div>
				<br>
			
		</div>
	
	<div id="exportRow" class="row">
		<button class="btn btn-hg btn-primary btn-reduce-on-xs btn-embossed" onclick="exportHTMLfile()" data-toggle="tooltip" data-placement="left" data-html="true" title="Press to create AR HTML file and choose where to save it. <br> Typically the filename should remain index.html" style="position:relative; margin-left:50%; left:-100px; ">
		  Create HTML
		</button>
	</div>
	<div id="nextStepsContainer" class="row">
	<h4>Next Steps:</h4>
		<ol>
			<li>Once you've saved your new AR experience HTML  file send it to your hosting contact to upload online.</li>
			<br>
			<li>Zip of required files to be placed with this HTML export: <i>to be attached here once assets are finalized</i>
			</li>
		</ol>
	</div>
	</div>
</div>
<br>
	<div id="versionContainer" class="container">
		<p class="img-comment">
		Tool Version: <data id="toolVersion">x.x.x</data>
		<br>
		Template Version: <data id="templateVersion">x.x.x</data>
		</p>
	</div>
	<div id="footer" class="container">
	
	  <nav class="navbar navbar-inverse navbar-expand-lg" role="navigation">
			<!-- Navbar content -->
			<img src="https://headgear.io/assets/img/IMG_0088.PNG" style="width:50px; height:50px;"><a class="navbar-brand" href="https://headgear.io" target="_blank">© Copyright 2020 HEADGEAR Gbr</a><img src="https://headgear.io/assets/img/IMG_0088.PNG" style="width:50px; height:50px; -webkit-transform: scaleX(-1); transform: scaleX(-1);">


	</div>

</div>

<script>
//set version numbers
	document.getElementById("toolVersion").textContent = toolVersionVar;
	
</script>


    <!-- Bootstrap and Flat UI libraries: jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
		  
	<!-- Flat UI scripts start -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/flat-ui/2.3.0/js/flat-ui.js" crossorigin="anonymous"></script> 
	

<script>
//Scripts for HTML elements -> switches drop downs etc.
	
	//switch between video & photo
	function switchVideoPhotoDiv() {

		if (document.getElementById("videoElsePhoto_value").checked) {
			document.getElementById("videoInfo").style.display = 'block';
			document.getElementById("photoInfo").style.display = 'none';
		} else {
			document.getElementById("videoInfo").style.display = 'none';
			document.getElementById("photoInfo").style.display = 'block';
		}
	}

	
	//Video and image previewer functions
		//video preview
		function previewVideo() {
			
			var videoPlayer = videojs('videoPreviewWindow');

			if (debug == '1') {  
				if (!document.getElementById("videoURL_value").value) {
					videoPlayer.src({type: 'video/mp4', src: 'https://vatelier.net/MyDemo/videosphere-showcase/city_halfres.mp4'});
				}
			} else {
				videoPlayer.src({type: 'video/mp4', src: document.getElementById("videoURL_value").value});
			}
			videoPlayer.ready(function() {
					videoPlayer.play();
				
			});
			
		}
		//image preview
		function previewImage() {
			
			if (debug == '1') {  
				if (!document.getElementById("photoURL_value").value) {
					document.getElementById("photoPreviewWindow").src = 'https://headgear.io/8thwall/assets/video_thumbnail.jpg'
				}
			} else {
				document.getElementById("photoPreviewWindow").src = document.getElementById("photoURL_value").value;
			}
			
			var image = document.getElementById('photoPreviewWindow');
			document.getElementById("photoFormGroup").classList.remove("has-error");
			document.getElementById("photoFormGroup").classList.add("has-success");

			image.onerror = function () {
				addErrorInfoText('audioFormGroup', 'Problem displaying file: ' + audioURL + '. Ensure it is a jpg or png', 'red');
				document.getElementById("photoFormGroup").classList.remove("has-success");
				document.getElementById("photoFormGroup").classList.add("has-error");
				//this.src = 'error.png'; // place your error.png image instead
			};
			
		}
		//audio preview
		function previewAudio(audioPlayerIdPassthrough, newSourceURL, formGroupIdPassthrough) {
			var audioPlayer = document.getElementById(audioPlayerIdPassthrough);
			var audioFormGroup = document.getElementById(formGroupIdPassthrough);
			if (debug == '1') {  
				if (!newSourceURL) {
					audioPlayer.src = 'https://media.w3.org/2010/05/sound/sound_90.mp3'
				}
			} else {
				audioPlayer.src = newSourceURL.value;
			}
			
			//validate source - onerror event
			audioPlayer.onerror = event => {
				var sourceElement = event.target;
				var audioURL = sourceElement.getAttribute("src");
				fetch(audioURL).then(function(response) {
					//alert(response.status);
				});
				addErrorInfoText(formGroupIdPassthrough, 'Problem playing file: ' + audioURL + '. Ensure it is a mp3 file.', 'red');
				audioFormGroup.classList.remove("has-success");
				audioFormGroup.classList.add("has-error");
				return
			};
			audioFormGroup.classList.remove("has-error");
			audioFormGroup.classList.add("has-success");
			audioPlayer.load(); //call this to just preload the audio without playing
			audioPlayer.play(); //call this to play the song right away

			
		}
		
	//setup Tracking
	function setupTracking(trackingProviderPassthrough) {
		document.getElementById("trackingProvider_value").textContent = trackingProviderPassthrough;
	}
	function setRotation(rotationPassthrough) {
		document.getElementById("360Rotation_value").textContent = rotationPassthrough;
	}
</script>

<script>
	//validate URLs
	function setStatus(url, elementId) {
		console.log(elementId);
		element = document.getElementById(elementId);
		
		//clear any existing responces info/css:
		if ($('#info_' + elementId).length) {$('#info_' + elementId).remove();}
		element.classList.remove("has-success");
		element.classList.remove("has-error");
			
		//A few basic checks on the URL string first:
		if (!url) { //empty field
			element.classList.remove("has-success");
			element.classList.remove("has-error");
		} else if ((url.substring(0,5) == "http:") || (url.substring(0,5) == "HTTP:")) { //only HTTP://
			element.classList.remove("has-success");
			element.classList.add("has-error");
			addErrorInfoText(elementId, "Resource needs to be stored on https://", 'red');
		} else {
			
			// https request logic
			var request = new XMLHttpRequest();
			//get event response ready
			request.onreadystatechange = function() {
				if (request.readyState === 4){
					request.status;//this contains the status code
					console.log(request.status);
					console.log(url.substring(0,6));
					if (((request.status == '0') && (url.substring(0,6) == "https:")) || ((request.status == '0') && (url.substring(0,6) == "https:"))) { //Missing CORS header
						element.classList.remove("has-success");
						element.classList.remove("has-error");
						addErrorInfoText(elementId, "Seems like CORS cross-domain header is not set on server side. This may still be ok check with the preview button or try manually opening.", 'grey');
					} else if (request.status == '0') { //local reference?
						element.classList.remove("has-success");
						element.classList.remove("has-error");
						addErrorInfoText(elementId, "Relative and absolute links cannot be checked. Make sure the folder structure matches what you plan server side.", 'grey');
					} else if (request.status == '200') { //200 successfuly found
						element.classList.remove("has-error");
						element.classList.add("has-success");
					} else if ((url.substring(0,4) != "http") || (url.substring(0,4) != "HTTP")) {
						element.classList.remove("has-success");
						element.classList.remove("has-error");
						addErrorInfoText(elementId, "Relative and absolute links cannot be checked. Make sure the folder structure matches what you plan server side.", 'grey');
					} else {  //most likely an erro eg: 404
						element.classList.add("has-error");
						element.classList.remove("has-success");
						addErrorInfoText(elementId, 'File not found: ' + request.status, 'red');
					}
				}
			};
			//make https request
			request.open("GET", url, true);
			request.send(); 
		}
	} 
	//add error message under input field
	function addErrorInfoText(elementId, text, color) {
		$('#' + elementId).append('<p id="info_' + elementId +'" class="img-comment" style="color: ' + color + '; margin: 0 0 15px !important;"><strong>Note:</strong> ' + text);
	}
	
	function overlayOn() {
		document.getElementById("overlay").style.display = "block";
	}

	function overlayOff() {
		document.getElementById("overlay").style.display = "none";
	}
	
</script>
<script>

//export and field values scripts

function clearForm() {

	//get new values from input form
	document.getElementById("appKey_value").value = "";
	document.getElementById("videoURL_value").value  = "";
	document.getElementById("doorModel_value").value = "";
	document.getElementById("balconyModel_value").value = "";
	document.getElementById("narrative_value").value = "";
	document.getElementById('narrative_value').disabled = true
	document.getElementById("videoElsePhoto_value").checked = true;
	document.getElementById("photoURL_value").value = "";
	document.getElementById("pageTitle_value").value = "";
	document.getElementById("showBalcony_value").checked = true;
	document.getElementById("sceneLocation_value").checked  = false;
	document.getElementById("sceneLocationText_value").value = "";
	document.getElementById('sceneLocationText_value').disabled = true
	document.getElementById("trackingParameter_value").value = "";
	document.getElementById('trackingParameter_value').disabled = true
	document.getElementById("trackingProvider_value").textContent = "Choose Tracking Provider";
	document.getElementById("infoLink_value").value = "";
	document.getElementById('infoLink_value').disabled = true
	document.getElementById("360Rotation_value").textContent = "90";
	document.getElementById("showInfoButton_value").checked = false;	
	document.getElementById("showNarrativeAudioButton_value").checked = false;	
	document.getElementById("containsDoorSpawningSound_value").checked = false;
	document.getElementById("doorSpawningSound_value").value = "";
	document.getElementById('doorSpawningSound_value').disabled = true
}

	//call set defaults as on a page reload they are not set
	clearForm();

// Scripts for export	

//assign array
var stringsToReplaceArray = [
		appKey_var, //0: appkey
		videoURL_var, //1: video URL
		doorModel_var, //2: door model URL
		balconyModel_var, //3: balcony URL
		narrative_var, //4: narrative audio URL
		videoElsePhoto_var, //5: videoOrPhoto boolean
		photoURL_var, //6: photo URL
		pageTitle_var, //7: page Title - multiple occerances!
		showBalcony_var, //8: balcony onOff boolean
		sceneLocation_var, //9: boolean for showing text above door
		sceneLocationText_var, //10: text to be shown above door
		trackingParameter_var, //11: tracking id for this campaign
		trackingProvider_var, //12: tracking provider for this campaign
		infoLink_var, //13: URL for the info button
		Rotation360_var, //14: intial rotation of 360 content
		showInfoButton_var, //15: whether info button is included
		showNarrativeAudioButton_var, //16: whether info button is included
		containsDoorSpawningSound_var, //17 whether to play a door spawning sound
		doorSpawningSound_var, //18: url for door spawning sound
	];

function setLookupValues() {

	//Lookup values for template!! -> do not change!!!
	var appKey_var = "gLMESoMSiCXZ8Ye4C7ooAO5bRn59zFpGIxN07SWCegxZNtScEoTCxh8S9SsXTB8xOevOSn"; //0: appkey
	var videoURL_var = "./assets/360_video.mp4"; //1: video URL
	var doorModel_var =	"./assets/door_model.glb"; //2: door model URL
	var balconyModel_var = "./assets/balcony_model.glb"; //3: balcony URL
	var narrative_var =	"./assets/narrative.mp3"; //4: narrative audio URL
	var videoElsePhoto_var = "videoElsePhoto = true"; //5: videoOrPhoto boolean
	var photoURL_var = "./assets/video_thumbnail.jpg"; //6: photo URL
	var pageTitle_var = "AR Portal"; //7: page Title - multiple occerances!
	var showBalcony_var = "showBalcony = true"; //8: balcony onOff boolean
	var sceneLocation_var = "sceneLocationText = false"; //9: boolean for showing text above door
	var sceneLocationText_var = "Scene Location"; //10: text to be shown above door
	var trackingParameter_var = "uid_1234567890"; //11: tracking id for this campaign
	var trackingProvider_var = 'trackingProvider = "None"' //12: tracking provider
	var infoLink_var = 'var infoURL = "https://headgear.io"' //13: Info Link
	var Rotation360_var = 'rotation="0 90 0"' //14: intial rotation of 360 content
	var showInfoButton_var = "infoLinkExists = true"; //15: whether to show the info button
	var showNarrativeAudioButton_var = "narrativeAudioExists = true"; //16: whether to show the narrative audio button
	var containsDoorSpawningSound_var = "containsDoorSpawningSound = true"; //17 whether to play a door spawning sound
	var doorSpawningSound_var = '"doorSpawningAudio" src="door_spawning_sound.mp3"'; //18: url for door spawning sound
	
	//update array
	stringsToReplaceArray = [
		appKey_var, //0: appkey
		videoURL_var, //1: video URL
		doorModel_var, //2: door model URL
		balconyModel_var, //3: balcony URL
		narrative_var, //4: narrative audio URL
		videoElsePhoto_var, //5: videoOrPhoto boolean
		photoURL_var, //6: photo URL
		pageTitle_var, //7: page Title - multiple occerances!
		showBalcony_var, //8: balcony onOff boolean
		sceneLocation_var, //9: boolean for showing text above door
		sceneLocationText_var, //10: text to be shown above door
		trackingParameter_var, //11: tracking id for this campaign
		trackingProvider_var, //12: tracking provider for this campaign
		infoLink_var, //13: URL for the info button
		Rotation360_var, //14: intial rotation of 360 content
		showInfoButton_var, //15: whether info button is included
		showNarrativeAudioButton_var, //16: whether info button is included
		containsDoorSpawningSound_var, //17 whether to play a door spawning sound
		doorSpawningSound_var, //18: url for door spawning sound
	];

}
	
function exportHTMLfile() {

	//get lookupvalues
	setLookupValues();
				
	//get new values from input form
	appKey_var = document.getElementById("appKey_value").value;
	videoURL_var = document.getElementById("videoURL_value").value;
	doorModel_var = document.getElementById("doorModel_value").value;
	balconyModel_var = document.getElementById("balconyModel_value").value;
	narrative_var = document.getElementById("narrative_value").value;
	videoElsePhoto_var = 'videoElsePhoto = ' + document.getElementById("videoElsePhoto_value").checked;
	photoURL_var = document.getElementById("photoURL_value").value;
	pageTitle_var = document.getElementById("pageTitle_value").value;
	showBalcony_var = "showBalcony = " + document.getElementById("showBalcony_value").checked;
	sceneLocation_var = "sceneLocationText = " + document.getElementById("sceneLocation_value").checked;
	sceneLocationText_var = document.getElementById("sceneLocationText_value").value;
	trackingParameter_var = document.getElementById("trackingParameter_value").value;
	trackingProvider_var = 'trackingProvider = "' + document.getElementById("trackingProvider_value").textContent + '"';
	infoLink_var = 'var infoURL = "' + document.getElementById("infoLink_value").value + '"';
	Rotation360_var = 'rotation="0 ' + document.getElementById("360Rotation_value").textContent + ' 0"';
	showInfoButton_var = 'infoLinkExists = ' + document.getElementById("showInfoButton_value").checked;
	showNarrativeAudioButton_var = 'narrativeAudioExists = ' + document.getElementById("showNarrativeAudioButton_value").checked;
	containsDoorSpawningSound_var = 'containsDoorSpawningSound = ' + document.getElementById("containsDoorSpawningSound_value").checked;
	doorSpawningSound_var = '"doorSpawningAudio" src="' + document.getElementById("doorSpawningSound_value").value + '"';
	
	//vars which are overwritten by default template vars:
	templateDefaults(templateName_var);
	
	
	//if required values are there
	if (pageTitle_var && appKey_var && doorModel_var) {
		if ((videoURL_var) || (photoURL_var)) {
				
				templateContents_replaced = templateContents
				//string replacing:
				templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[0], appKey_var);
				templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[1], videoURL_var);
				templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[2],doorModel_var);
				templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[3], balconyModel_var);
				templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[4], narrative_var);
				templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[5], videoElsePhoto_var);
				templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[6], photoURL_var);
				//templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[7], pageTitle_var);
				templateContents_replaced = templateContents_replaced.split(stringsToReplaceArray[7]).join(pageTitle_var); //different command as page title is to be replaced in multiple locations
				templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[8], showBalcony_var);
				templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[9], sceneLocation_var);
				templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[10], sceneLocationText_var);
				templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[11], trackingParameter_var);
				templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[12], trackingProvider_var);
				templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[13], infoLink_var);
				templateContents_replaced = templateContents_replaced.split(stringsToReplaceArray[14]).join(Rotation360_var); //different command as page title is to be replaced in multiple locations
				templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[15], showInfoButton_var);
				templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[16], showNarrativeAudioButton_var);
				templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[17], containsDoorSpawningSound_var);
				templateContents_replaced = templateContents_replaced.replace(stringsToReplaceArray[18], doorSpawningSound_var);
				
				//save and download
				save('index', templateContents_replaced);
				
		}
	}
	else {
		alert("Check you have entered in the required fields correctly!\nAt least the appkey, page title, door model and one of video or photo URLs must be entered correctly.")
	}
}

// save function to save the contents of the template to a new file
// contains extra contents 
function save(filename, templateContents) {
    var blob = new Blob([templateContents], {type: 'text/html'});
    if(window.navigator.msSaveOrOpenBlob) {
        window.navigator.msSaveBlob(blob, filename + ".html");
    }
    else{
        var elem = window.document.createElement('a');
        elem.href = window.URL.createObjectURL(blob);
        elem.download = filename + ".html";        
        document.body.appendChild(elem);
        elem.click();        
        document.body.removeChild(elem);
    }
}

// set debug parameter. If debug=1 in URL then set true

var debug = getUrlParam('debug','false');

if (debug == 1) { 
	templateName_var = "generic"; 
	loadTemplate(templateName_var); 
}
function getUrlParam(parameter, defaultvalue){
    var urlparameter = defaultvalue;
    if(window.location.href.indexOf(parameter) > -1){
        urlparameter = getUrlVars()[parameter];
        }
    return urlparameter;
}
function getUrlVars() {
    var vars = {};
    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
        vars[key] = value;
    });
    return vars;
}



//export scripts end
// brand template scripts


function loadTemplate(templateName) {
	//assign correct template file
	if (templateName == "WAmS") {
		var templateToLoadName = 'WAmS_template.html'
	} else if (templateName == "generic") {
		var templateToLoadName = 'WAmS_template.html'
	}
	
	var script = document.createElement('script');
	script.onload = function () {
		//debug output to check file was read correctly
		if (typeof templateContents !== 'undefined') {
			  //console.log(templateContents);
			  
			  //show / hide correct fields for this template
			  showTemplateFields(templateName)
			  if (typeof templateVersion !== 'undefined') {
				var templateVersionVar = templateVersion;
				document.getElementById("templateVersion").textContent = templateVersionVar;
			}
		} else {
			var templateVersionVar = "Template not loaded correctly";
			alert('Template file is missing!\n\nPlease make sure the file "template_to_load.html" is placed in the same location as this tool!\n\n\nContact Headgear support if you continue to have issues: support@headgear.io');
		}
	};
	script.src = templateToLoadName;
	document.head.appendChild(script);
	
}
		
function showTemplateFields(templateName) {
	if (templateName == "generic") {
		//configure visibility of invidivual divs:
		document.getElementById("pageTitleContainer").style.display = "block";	
		document.getElementById("keyKeyContainer").style.display = "block";	
		document.getElementById("360videoOrPhotoContainer").style.display = "block";	
		document.getElementById("modelContainer").style.display = "block";	
		document.getElementById("doorSpawningSoundContainer").style.display = "block";	
		document.getElementById("sceneLocationContainer").style.display = "block";	
		document.getElementById("infoLinkContainer").style.display = "block";	
		document.getElementById("trackingContainer").style.display = "block";	
		//show parent content div
		document.getElementById("templateContent").style.display = "block";		
	}
	else if (templateName == "WAmS") {
		//configure visibility of invidivual divs:
		document.getElementById("pageTitleContainer").style.display = "block";	
		document.getElementById("keyKeyContainer").style.display = "block";	
		document.getElementById("360videoOrPhotoContainer").style.display = "block";	
		document.getElementById("modelContainer").style.display = "none";	
		document.getElementById("doorSpawningSoundContainer").style.display = "none";	
		document.getElementById("sceneLocationContainer").style.display = "block";	
		document.getElementById("infoLinkContainer").style.display = "block";	
		document.getElementById("trackingContainer").style.display = "none";	
		//show parent content div
		document.getElementById("templateContent").style.display = "block";		
	}
}

function templateDefaults(templateName) {
	
	//uncommented vars are hardcoded and used to overwrite on export
	if (templateName == "WAmS") {
		//appKey_var = "gLMESoMSiCXZ8Ye4C7ooAO5bRn59zFpGIxN07SWCegxZNtScEoTCxh8S9SsXTB8xOevOSn"; //0: appkey
		//videoURL_var = "./assets/360_video.mp4"; //1: video URL
		doorModel_var =	"./assets/door_model.glb"; //2: door model URL
		balconyModel_var = "./assets/balcony_model.glb"; //3: balcony URL
		//narrative_var =	"./assets/narrative.mp3"; //4: narrative audio URL
		//videoElsePhoto_var = "videoElsePhoto = true"; //5: videoOrPhoto boolean
		//photoURL_var = "./assets/video_thumbnail.jpg"; //6: photo URL
		//pageTitle_var = "AR Portal"; //7: page Title - multiple occerances!
		showBalcony_var = "showBalcony = true"; //8: balcony onOff boolean
		//sceneLocation_var = "sceneLocationText = false"; //9: boolean for showing text above door
		//sceneLocationText_var = "Scene Location"; //10: text to be shown above door
		//trackingParameter_var = "uid_1234567890"; //11: tracking id for this campaign
		trackingProvider_var = 'trackingProvider = "Tealium"' //12: tracking provider
		//infoLink_var = 'var infoURL = "https://headgear.io"' //13: Info Link
		//Rotation360_var = 'rotation="0 90 0"' //14: intial rotation of 360 content
		//showInfoButton_var = "infoLinkExists = true"; //15: whether to show the info button
		//showNarrativeAudioButton_var = "narrativeAudioExists = true"; //16: whether to show the narrative audio button
		containsDoorSpawningSound_var = "containsDoorSpawningSound = true"; //17 whether to play a door spawning sound
		doorSpawningSound_var = '"doorSpawningAudio" src="door_spawning_sound.mp3"'; //18: url for door spawning sound
	}
}

//template scripts end

</script>

<script>
	//Flat UI specific functions
	
	//enable tooltips
	$(function () {
	  $('[data-toggle="tooltip"]').tooltip()
	})

    // Focus state for append/prepend inputs
    $('.input-group:not(.fileinput)').on('focus', '.form-control', function () {
      $(this).closest('.input-group, .form-group').addClass('focus');
    }).on('blur', '.form-control', function () {
      $(this).closest('.input-group, .form-group').removeClass('focus');
    });
	
	// Switches
    if ($('[data-toggle="switch"]').length) {
      $('[data-toggle="switch"]').bootstrapSwitch();
    }
	
</script>
	<!-- Flat UI scripts end -->




	
  </body>
</html>